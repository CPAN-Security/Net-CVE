.\" -*- mode: troff; coding: utf-8 -*-
.\" Automatically generated by Pod::Man v6.0.2 (Pod::Simple 3.45)
.\"
.\" Standard preamble:
.\" ========================================================================
.de Sp \" Vertical space (when we can't use .PP)
.if t .sp .5v
.if n .sp
..
.de Vb \" Begin verbatim text
.ft CW
.nf
.ne \\$1
..
.de Ve \" End verbatim text
.ft R
.fi
..
.\" \*(C` and \*(C' are quotes in nroff, nothing in troff, for use with C<>.
.ie n \{\
.    ds C` ""
.    ds C' ""
'br\}
.el\{\
.    ds C`
.    ds C'
'br\}
.\"
.\" Escape single quotes in literal strings from groff's Unicode transform.
.ie \n(.g .ds Aq \(aq
.el       .ds Aq '
.\"
.\" If the F register is >0, we'll generate index entries on stderr for
.\" titles (.TH), headers (.SH), subsections (.SS), items (.Ip), and index
.\" entries marked with X<> in POD.  Of course, you'll have to process the
.\" output yourself in some meaningful fashion.
.\"
.\" Avoid warning from groff about undefined register 'F'.
.de IX
..
.nr rF 0
.if \n(.g .if rF .nr rF 1
.if (\n(rF:(\n(.g==0)) \{\
.    if \nF \{\
.        de IX
.        tm Index:\\$1\t\\n%\t"\\$2"
..
.        if !\nF==2 \{\
.            nr % 0
.            nr F 2
.        \}
.    \}
.\}
.rr rF
.\"
.\" Required to disable full justification in groff 1.23.0.
.if n .ds AD l
.\" ========================================================================
.\"
.IX Title "Net::CVE 3"
.TH Net::CVE 3 2025-01-06 "perl v5.40.0" "User Contributed Perl Documentation"
.\" For nroff, turn off justification.  Always turn off hyphenation; it makes
.\" way too many mistakes in technical documents.
.if n .ad l
.nh
.SH NAME
Net::CVE \- Fetch CVE (Common Vulnerabilities and Exposures) information from cve.org
.SH SYNOPSIS
.IX Header "SYNOPSIS"
.Vb 1
\& use Net::CVE;
\&
\& my $cr = Net::CVE\->new ();
\&
\& $cr\->get ("CVE\-2022\-26928");
\& my $full_report = $cr\->data;
\& my $summary     = $cr\->summary;
\&
\& $cr\->diag;
\&
\& use Data::Peek;
\& DDumper $cr\->summary ("CVE\-2022\-26928");
.Ve
.SH DESCRIPTION
.IX Header "DESCRIPTION"
This module provides a Perl interface to retrieve information from the
CVE database <https://www.cve.org/Downloads> provided by <https://cve.org>
based on a CVE tag.
.SH METHODS
.IX Header "METHODS"
.SS new
.IX Subsection "new"
.Vb 5
\& my $reporter = CVE\->new (
\&     url  => "https://cveawg.mitre.org/api/cve",
\&     ua   => undef,
\&     lang => "en",
\&     );
.Ve
.PP
Instantiates a new object. All attributes are optional.
.IP url 2
.IX Item "url"
Base url for REST API
.IP ua 2
.IX Item "ua"
User agent. Needs to know about \f(CW\*(C`\->get\*(C'\fR. Defaults to HTTP::Tiny.
Initialized on first use.
.Sp
.Vb 1
\& my $reporter = CVE\->new (ua => HTTP::Tiny\->new);
.Ve
.Sp
Other agents not yet tested, so they might fail.
.IP lang 2
.IX Item "lang"
Set preferred language for "summary". Defaults to \f(CW\*(C`en\*(C'\fR.
.Sp
If the preferred language is present in descriptions use that. If it is not, use
\&\f(CW\*(C`en\*(C'\fR. If that is also not present, use the first language found.
.SS get
.IX Subsection "get"
.Vb 3
\& $reporter\->get ("CVE\-2022\-26928");
\& $reporter\->get ("2022\-26928");
\& $reporter\->get ("Files/CVE\-2022\-26928.json");
.Ve
.PP
Fetches the CVE data for a given tag. On success stores the results internally.
Returns the object. The leading \f(CW\*(C`CVE\-\*(C'\fR is optional.
.PP
If the argument is a non\-empty file, that is parsed instead of fetching the
information from the internet.
.PP
The decoded information is stored internally and will be re\-used for other
methods.
.PP
\&\f(CW\*(C`get\*(C'\fR returns the object and allows to omit a call to \f(CW\*(C`new\*(C'\fR which will be
implicit but does not allow attributes
.PP
.Vb 1
\& my $reporter = Net::CVE\->get ("2022\-26928");
.Ve
.PP
is a shortcut to
.PP
.Vb 1
\& my $reporter = Net::CVE\->new\->get ("2022\-26928");
.Ve
.SS data
.IX Subsection "data"
.Vb 1
\& my $info = $reporter\->data;
.Ve
.PP
Returns the data structure from the last successful fetch, \f(CW\*(C`undef\*(C'\fR if none.
.PP
Giving an argument enables you to skip the "get" call, which is implicit, so
.PP
.Vb 1
\& my $info = $reporter\->data ("CVE\-2022\-26928");
.Ve
.PP
is identical to
.PP
.Vb 1
\& my $info = $reporter\->get ("CVE\-2022\-26928")\->data;
.Ve
.PP
or
.PP
.Vb 2
\& $reporter\->get ("CVE\-2022\-26928");
\& my $info = $reporter\->data;
.Ve
.PP
or even, without an object
.PP
.Vb 1
\& my $info = Net::CVE\->data ("CVE\-2022\-26928");
.Ve
.SS summary
.IX Subsection "summary"
.Vb 2
\& my $info = $reporter\->summary;
\& my $info = $reporter\->summary ("CVE\-2022\-26928");
.Ve
.PP
Returns a hashref with basic information from the last successful fetch,
\&\f(CW\*(C`undef\*(C'\fR if none.
.PP
Giving an argument enables you to skip the "get" call, which is implicit, so
.PP
.Vb 1
\& my $info = $reporter\->summary ("CVE\-2022\-26928");
.Ve
.PP
is identical to
.PP
.Vb 1
\& my $info = $reporter\->get ("CVE\-2022\-26928")\->summary;
.Ve
.PP
or
.PP
.Vb 2
\& $reporter\->get ("CVE\-2022\-26928");
\& my $info = $reporter\->summary;
.Ve
.PP
or even, without an object
.PP
.Vb 1
\& my $info = Net::CVE\->summary ("CVE\-2022\-26928");
.Ve
.PP
The returned hash looks somewhat like this
.PP
.Vb 10
\& { date        => "2022\-09\-13T18:41:25",
\&   description => "Windows Photo Import API Elevation of Privilege Vulnerability",
\&   id          => "CVE\-2022\-26928",
\&   problem     => "Elevation of Privilege",
\&   score       => "7",
\&   severity    => "high",
\&   status       => "PUBLISHED",
\&   vendor      => [ "Microsoft" ]
\&   platforms   => [ "32\-bit Systems",
\&       "ARM64\-based Systems",
\&       "x64\-based Systems",
\&       ],
\&   product     => [
\&       "Windows 10 Version 1507",
\&       "Windows 10 Version 1607",
\&       "Windows 10 Version 1809",
\&       "Windows 10 Version 20H2",
\&       "Windows 10 Version 21H1",
\&       "Windows 10 Version 21H2",
\&       "Windows 11 version 21H2",
\&       "Windows Server 2016",
\&       "Windows Server 2019",
\&       "Windows Server 2022",
\&       ],
\&   }
.Ve
.PP
As this is work in progress, likely to be changed
.SS status
.IX Subsection "status"
.Vb 1
\& my $status = $reporter\->status;
.Ve
.PP
Returns the status of the CVE, most likely \f(CW\*(C`PUBLISHED\*(C'\fR.
.SS vendor
.IX Subsection "vendor"
.Vb 2
\& my @vendor  = $reporter\->vendor;
\& my $vendors = $reporter\->vendor;
.Ve
.PP
Returns the list of vendors for the affected parts of the CVE. In scalar
context a string where the (sorted) list of unique vendors is joined by
\&\f(CW\*(C`, \*(C'\fR in list context the (sorted) list itself.
.SS product
.IX Subsection "product"
.Vb 2
\& my @product  = $reporter\->product;
\& my $products = $reporter\->product;
.Ve
.PP
Returns the list of products for the affected parts of the CVE. In scalar
context a string where the (sorted) list of unique products is joined by
\&\f(CW\*(C`, \*(C'\fR in list context the (sorted) list itself.
.SS platforms
.IX Subsection "platforms"
.Vb 2
\& my @platform  = $reporter\->platforms;
\& my $platforms = $reporter\->platforms;
.Ve
.PP
Returns the list of platforms for the affected parts of the CVE. In scalar
context a string where the (sorted) list of unique platforms is joined by
\&\f(CW\*(C`, \*(C'\fR in list context the (sorted) list itself.
.SS diag
.IX Subsection "diag"
.Vb 2
\& $reporter\->diag;
\& my $diag = $reporter\->diag;
.Ve
.PP
If an error occurred, returns information about the error. In void context
prints the diagnostics using \f(CW\*(C`warn\*(C'\fR. The diagnostics \- if any \- will be
returned in a hashref with the following fields:
.IP status 2
.IX Item "status"
Status code
.IP reason 2
.IX Item "reason"
Failure reason
.IP action 2
.IX Item "action"
Tag of where the failure occurred
.IP source 2
.IX Item "source"
The URL or filename leading to the failure
.IP usage 2
.IX Item "usage"
Help message
.PP
Only the \f(CW\*(C`action\*(C'\fR field is guaranteed to be set, all others are optional.
.SH BUGS
.IX Header "BUGS"
None so far
.SH TODO
.IX Header "TODO"
.IP "Better error reporting" 2
.IX Item "Better error reporting"
Obviously
.IP Tests 2
.IX Item "Tests"
There are none yet
.IP Meta\-stuff 2
.IX Item "Meta-stuff"
Readme, Changelog, Makefile.PL, ...
.IP "Fallback to Net::NVD" 2
.IX Item "Fallback to Net::NVD"
Optionally. It does not (yet) provide vendor, product and platforms.
It however provides nice search capabilities.
.IP "RHSA support" 2
.IX Item "RHSA support"
Extend to return results for \f(CW\*(C`RHSA\-2023:1791\*(C'\fR type vulnerability tags.
.Sp
.Vb 2
\& https://access.redhat.com/errata/RHSA\-2023:1791
\& https://access.redhat.com/hydra/rest/securitydata/crf/RHSA\-2023:1791.json
.Ve
.Sp
The CRF API provides the list of CVE\*(Aqs related to this tag:
.Sp
.Vb 4
\& my $url = "https://access.redhat.com/hydra/rest/securitydata/crf";
\& my $crf = decode_json ($ua\->get ("$url/RHSA\-2023:1791.json"));
\& my @cve = map { $_\->{cve} }
\&           @{$crf\->{cvrfdoc}{vulnerability} || []}
.Ve
.Sp
Will set \f(CW@cve\fR to
.Sp
.Vb 3
\& qw( CVE\-2023\-1945  CVE\-2023\-1999  CVE\-2023\-29533 CVE\-2023\-29535
\&     CVE\-2023\-29536 CVE\-2023\-29539 CVE\-2023\-29541 CVE\-2023\-29548
\&     CVE\-2023\-29550 );
.Ve
.Sp
See the API documentation <https://access.redhat.com/documentation/en-us/red_hat_security_data_api/1.0/html-single/red_hat_security_data_api/index>.
.SH "SEE ALSO"
.IX Header "SEE ALSO"
.IP "CVE search" 2
.IX Item "CVE search"
<https://cve.org> and <https://cve.mitre.org/cve/search_cve_list.html>
.IP Net::OSV 2
.IX Item "Net::OSV"
Returns OpenSource Vulnerabilities.
.IP "CVE database" 2
.IX Item "CVE database"
<https://www.cvedetails.com/>
.SH AUTHOR
.IX Header "AUTHOR"
H.Merijn Brand <hmbrand@cpan.org>
.SH "COPYRIGHT AND LICENSE"
.IX Header "COPYRIGHT AND LICENSE"
Copyright (C) 2023\-2025 H.Merijn Brand
.PP
This library is free software; you can redistribute it and/or modify
it under the same terms as Perl itself. See perlartistic.
.PP
This interface uses data from the CVE API but is not endorsed by any
of the CVE partners.
.SH "DISCLAIMER OF WARRANTY"
.IX Header "DISCLAIMER OF WARRANTY"
BECAUSE THIS SOFTWARE IS LICENSED FREE OF CHARGE, THERE IS NO WARRANTY
FOR THE SOFTWARE, TO THE EXTENT PERMITTED BY APPLICABLE LAW. EXCEPT WHEN
OTHERWISE STATED IN WRITING THE COPYRIGHT HOLDERS AND/OR OTHER PARTIES
PROVIDE THE SOFTWARE "AS IS" WITHOUT WARRANTY OF ANY KIND, EITHER
EXPRESSED OR IMPLIED, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE. THE
ENTIRE RISK AS TO THE QUALITY AND PERFORMANCE OF THE SOFTWARE IS WITH
YOU. SHOULD THE SOFTWARE PROVE DEFECTIVE, YOU ASSUME THE COST OF ALL
NECESSARY SERVICING, REPAIR, OR CORRECTION.
.PP
IN NO EVENT UNLESS REQUIRED BY APPLICABLE LAW OR AGREED TO IN WRITING
WILL ANY COPYRIGHT HOLDER, OR ANY OTHER PARTY WHO MAY MODIFY AND/OR
REDISTRIBUTE THE SOFTWARE AS PERMITTED BY THE ABOVE LICENSE, BE
LIABLE TO YOU FOR DAMAGES, INCLUDING ANY GENERAL, SPECIAL, INCIDENTAL,
OR CONSEQUENTIAL DAMAGES ARISING OUT OF THE USE OR INABILITY TO USE
THE SOFTWARE (INCLUDING BUT NOT LIMITED TO LOSS OF DATA OR DATA BEING
RENDERED INACCURATE OR LOSSES SUSTAINED BY YOU OR THIRD PARTIES OR A
FAILURE OF THE SOFTWARE TO OPERATE WITH ANY OTHER SOFTWARE), EVEN IF
SUCH HOLDER OR OTHER PARTY HAS BEEN ADVISED OF THE POSSIBILITY OF
SUCH DAMAGES.
